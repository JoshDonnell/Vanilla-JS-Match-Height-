export default class o{constructor(e,t={}){this.element=e,this.options={parent:t.parent??null,byRow:t.byRow??!0,timeOut:t.timeOut??50},this.elements={},e?(window.addEventListener("DOMContentLoaded",()=>{setTimeout(()=>{this.reset()},this.options.timeOut)}),window.addEventListener("resize",()=>{setTimeout(()=>{this.update()},200)})):console.error("\u26D4 Missing class name in new MatchHeight()")}findElements(){if(this.options.parent&&document.querySelectorAll(this.options.parent).length)document.querySelectorAll(this.options.parent).forEach(e=>{let t=e.querySelectorAll(this.element);this.elements.push(t),this.findRows(t,e)});else{let e=document.querySelectorAll(this.element);this.elements.push(e),this.findRows(e)}}findRows(e,t=null){if(e.length){let n=[];e.forEach(s=>{let l=0;this.options.byRow&&(l=Math.round(s.getBoundingClientRect().top+window.scrollY)),n.push({offset:l,parent:t,elements:{element:s}})});const i=new Map(n.map(({offset:s,elements:l})=>[s,{offset:s,elements:[]}]));for(let{offset:s,elements:l}of n)i.get(s).elements.push(...[l].flat());this.setHeights([...i.values()])}}setHeights(e){e.length&&e.forEach(t=>{let n=[];t.elements.forEach(s=>{let l=s.element;l.style.height=null,n.push(l.offsetHeight)});let i=Math.max.apply(Math,n);t.elements.forEach(s=>{s.element.style.height=i+"px"})})}update(){this.elements.length?this.elements.forEach(e=>{this.findRows(e)}):console.error(`\u26D4 Can't trigger update as no elements found for the MatchHeight element ${this.element}`)}reset(){this.elements=[],this.findElements()}debug(){setTimeout(()=>{this.elements?this.elements.forEach((e,t)=>{console.log(this.element+" Group "+(t+1)),e.forEach(n=>{console.log(n)}),console.log(`

`)}):console.log(`\u26D4 No cached MatchHeight elements found for "${this.element}" 

 Make sure this element exists on the current page.`)},500)}}
